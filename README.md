# Работа с сервером

#   Схема базы данных
![Схема базы данных](/image.png)


# Документация UserController

Эта документация описывает класс `UserController`, который отвечает за операции, связанные с пользователями, такие как создание, получение, удаление пользователей и установка токенов. Класс взаимодействует с базой данных с помощью SQL-запросов и возвращает ответы в формате JSON.

## Предварительные требования
Перед использованием `UserController`, убедитесь, что:
1. База данных настроена и доступна через модуль `db` (`require('../config')`).
2. Необходимые таблицы базы данных (например, `users`) созданы.

---

## Методы

### 1. **`createUser(req, res)`**
   Создает нового пользователя в базе данных.

   **Параметры запроса (Body)**:
   - `login` (строка): Логин пользователя.
   - `pass` (строка): Пароль пользователя.

   **SQL-запрос**:
   ```sql
   INSERT INTO users (login, pass, token) VALUES (?, ?, "");
   ```

   **Ответ**:
   - Возвращает данные вставленного пользователя в случае успеха.
   - Возвращает ошибку, если операция завершилась неудачей.

   **Пример**:
   ```json
   {
     "login": "example_user",
     "pass": "password123"
   }
   ```

---

### 2. **`getUser(req, res)`**
   Получает данные пользователя из базы данных на основе предоставленных логина и пароля.

   **Параметры запроса (Body)**:
   - `login` (строка): Логин пользователя.
   - `password` (строка): Пароль пользователя.

   **SQL-запрос**:
   ```sql
   SELECT * FROM users WHERE (login=? AND pass=?);
   ```

   **Ответ**:
   - Возвращает данные пользователя, если учетные данные совпадают.
   - Возвращает сообщение `"Данные не совпадают! Проверьте и повторите попытку"`, если учетные данные не совпадают.
   - Возвращает ошибку, если операция завершилась неудачей.

   **Пример**:
   ```json
   {
     "login": "example_user",
     "password": "password123"
   }
   ```

---

### 3. **`deleteUser(req, res)`**
   Удаляет пользователя из базы данных на основе предоставленного ID пользователя.

   **Параметры запроса (Body)**:
   - `id` (целое число): ID пользователя для удаления.

   **SQL-запрос**:
   ```sql
   DELETE FROM users WHERE id = ?;
   ```

   **Ответ**:
   - Возвращает результат операции удаления.
   - Возвращает ошибку, если операция завершилась неудачей.

   **Пример**:
   ```json
   {
     "id": 1
   }
   ```

---

### 4. **`setUserToken(req, res)`**
   Обновляет токен для конкретного пользователя на основе его ID.

   **Параметры запроса (Body)**:
   - `user` (целое число): ID пользователя, для которого обновляется токен.
   - `token` (строка): Новый токен для пользователя.

   **SQL-запрос**:
   ```sql
   UPDATE users SET token = ? WHERE id = ?;
   ```

   **Ответ**:
   - Возвращает результат операции обновления.
   - Возвращает ошибку, если операция завершилась неудачей.

   **Пример**:
   ```json
   {
     "user": 1,
     "token": "new-token-value"
   }
   ```

---

## Пример использования

Вот как можно использовать `UserController` в обработчике маршрутов:

```javascript
const Router = require('express')
const router = new Router()
const userController = require('../controller/user.controller')

//Создание пользователя
router.post('/createUser', userController.createUser)

//Получение пользователя
router.post('/getuser', userController.getUser)

//Удаление пользователя
router.delete('/user', userController.deleteUser)

//Установка токена телефона к юзеру
router.put('/setusertoken', userController.setUserToken)


module.exports = router
```

---

## Обработка ошибок
- Все методы обрабатывают ошибки, возвращая JSON-ответ с сообщением об ошибке, если операции с базой данных завершились неудачей.
- Пример ответа с ошибкой:
   ```json
   {
     "error": "Сообщение об ошибке"
   }
   ```

---

